version: '3'

tasks:

  clean:
    desc: Clean up the project
    cmds:
      - rm -rf ./proto/gen
    silent: true

  proto:
    desc: Generate Go code from Protobuf files
    cmds:
      - protoc -I=proto --go_out=. --go-grpc_out=. proto/*.proto
      - echo "Protobuf files generated"
    silent: true

  compose:
    desc: Run a Docker Compose command
    cmds:
      - docker compose up -d --force-recreate
      - echo "Docker Compose started"
    silent: true

  mongosh:
    desc: Run a MongoDB shell command
    cmds:
      - docker exec -it mongodb  mongosh
    silent: false

  mongoclean:
    desc: Clean up MongoDB data
    cmds:
      - docker compose down
      - rm -rf ./mongodb_data
      - echo "MongoDB data cleaned up"
    silent: true